# goit-de-hw-06

# –õ–æ–≥—ñ–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–≤–¥–∞–Ω—å —É –ø—Ä–æ–µ–∫—Ç—ñ Kafka Sensor Monitoring

## –í—Å—Ç—É–ø
–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î —Å–∏—Å—Ç–µ–º—É –ø–æ—Ç–æ–∫–æ–≤–æ—ó –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö —Å–µ–Ω—Å–æ—Ä—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **Apache Kafka** —Ç–∞ **Apache Spark Streaming**. –û—Å–Ω–æ–≤–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è:

1. **–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–æ—Ç–æ–∫—É –¥–∞–Ω–∏—Ö**
2. **–ê–≥—Ä–µ–≥–∞—Ü—ñ—è –æ—Ç—Ä–∏–º–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö**
3. **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∞–ª–µ—Ä—Ç—ñ–≤**
4. **–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∞–ª–µ—Ä—Ç—ñ–≤**
5. **–ó–∞–ø–∏—Å –¥–∞–Ω–∏—Ö —É –≤–∏—Ö—ñ–¥–Ω–∏–π Kafka-—Ç–æ–ø—ñ–∫**

---

## 1Ô∏è‚É£ –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–æ—Ç–æ–∫—É –¥–∞–Ω–∏—Ö

### –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ
–°–∫—Ä–∏–ø—Ç `01_sensor_simulator.py` —ñ–º—ñ—Ç—É—î –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –ø–æ—Ç–æ–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö —É Kafka. –ö–æ–∂–µ–Ω –∑–∞–ø–∏—Å –º—ñ—Å—Ç–∏—Ç—å:

- `sensor_id` ‚Äì —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä —Å–µ–Ω—Å–æ—Ä–∞.
- `timestamp` ‚Äì —á–∞—Å–æ–≤–∏–π —à—Ç–∞–º–ø –ø–æ–¥—ñ—ó.
- `temperature` ‚Äì –≤–∏–ø–∞–¥–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏ (**30¬∞C ‚Äì 50¬∞C**).
- `humidity` ‚Äì –≤–∏–ø–∞–¥–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è –≤–æ–ª–æ–≥–æ—Å—Ç—ñ (**0% ‚Äì 100%**).

üìå –î–∞–Ω—ñ –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è —É **Kafka-—Ç–æ–ø—ñ–∫** `VN_building_sensors`.

---

## 2Ô∏è‚É£ –ê–≥—Ä–µ–≥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö

### –ú–µ—Ç–æ–¥–∏–∫–∞ –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è
–ü–æ—Ç—ñ–∫ –¥–∞–Ω–∏—Ö –∑—á–∏—Ç—É—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é **Spark Streaming** (`02_data_processor.py`).  
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **Sliding Window**:

- **–î–æ–≤–∂–∏–Ω–∞ –≤—ñ–∫–Ω–∞:** 1 —Ö–≤–∏–ª–∏–Ω–∞
- **–ó—Å—É–≤ –≤—ñ–∫–Ω–∞ (sliding interval):** 30 —Å–µ–∫—É–Ω–¥
- **Watermark duration:** 10 —Å–µ–∫—É–Ω–¥ (–¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é —Å–ø—ñ–∑–Ω—ñ–ª–∏—Ö –¥–∞–Ω–∏—Ö)

–û–±—á–∏—Å–ª—é—é—Ç—å—Å—è **—Å–µ—Ä–µ–¥–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è**:
- `t_avg` ‚Äì —Å–µ—Ä–µ–¥–Ω—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞
- `h_avg` ‚Äì —Å–µ—Ä–µ–¥–Ω—è –≤–æ–ª–æ–≥—ñ—Å—Ç—å

üìå –î–∞–Ω—ñ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è —É **Kafka-—Ç–æ–ø—ñ–∫** `VN_avg`.

---

## 3Ô∏è‚É£ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –∞–ª–µ—Ä—Ç—ñ–≤

### –§–∞–π–ª `alerts_conditions.csv`
–¶–µ–π —Ñ–∞–π–ª –º—ñ—Å—Ç–∏—Ç—å –∫—Ä–∏—Ç–µ—Ä—ñ—ó –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∞–Ω–æ–º–∞–ª—ñ–π:

- –ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ —Ç–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è **—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏** (`temperature_min`, `temperature_max`).
- –ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ —Ç–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è **–≤–æ–ª–æ–≥–æ—Å—Ç—ñ** (`humidity_min`, `humidity_max`).
- `alert_code` ‚Äì –∫–æ–¥ –∞–ª–µ—Ä—Ç—É.
- `alert_message` ‚Äì —Ç–µ–∫—Å—Ç —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è.

üìå –ó–Ω–∞—á–µ–Ω–Ω—è **-999** –æ–∑–Ω–∞—á–∞—î, —â–æ —Ü–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä **–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è** –¥–ª—è –∞–ª–µ—Ä—Ç—É.

---

## 4Ô∏è‚É£ –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∞–ª–µ—Ä—Ç—ñ–≤

–°–∫—Ä–∏–ø—Ç `03_alerts_processor.py` –≤–∏–∫–æ–Ω—É—î —Ç–∞–∫—ñ –¥—ñ—ó:

1. –ß–∏—Ç–∞—î —É—Å–µ—Ä–µ–¥–Ω–µ–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è `t_avg`, `h_avg` —ñ–∑ **Kafka-—Ç–æ–ø—ñ–∫–∞** `VN_avg`.
2. –í–∏–∫–æ–Ω—É—î **cross join** —ñ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∞–ª–µ—Ä—Ç—ñ–≤.
3. –§—ñ–ª—å—Ç—Ä—É—î –¥–∞–Ω—ñ, —è–∫—ñ **–≤–∏—Ö–æ–¥—è—Ç—å –∑–∞ –¥–æ–ø—É—Å—Ç–∏–º—ñ –º–µ–∂—ñ**.
4. –§–æ—Ä–º—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ —Å–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è –∞–ª–µ—Ä—Ç—É.

üìå –Ø–∫—â–æ —Å–µ–Ω—Å–æ—Ä –ø–µ—Ä–µ–≤–∏—â—É—î –∫—Ä–∏—Ç–∏—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, –∑–∞–ø–∏—Å —Ñ–æ—Ä–º—É—î—Ç—å—Å—è –¥–ª—è Kafka.

---

## 5Ô∏è‚É£ –ó–∞–ø–∏—Å –∞–ª–µ—Ä—Ç—ñ–≤ —É Kafka

–í–∏—è–≤–ª–µ–Ω—ñ –∞–ª–µ—Ä—Ç–∏ –∑–∞–ø–∏—Å—É—é—Ç—å—Å—è —É **Kafka-—Ç–æ–ø—ñ–∫** `VN_avg_alerts`.  
–ü—Ä–∏–∫–ª–∞–¥ –∑–∞–ø–∏—Å—É —É Kafka:

```json
{
    "window_start": "2025-01-27 12:00:00",
    "window_end": "2025-01-27 12:01:00",
    "t_avg": 47.5,
    "h_avg": 85.2,
    "alert_code": "T_HIGH",
    "alert_message": "High temperature detected",
    "timestamp": "2025-01-27 12:01:30"
}
